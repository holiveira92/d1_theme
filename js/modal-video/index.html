<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Modal Video</title>

    <link rel="stylesheet" href="./style.css">

    <script src="./plugins/jquery/jquery.js"></script>
    <script src="./plugins/jquery.fitvids/jquery.fitvids.js"></script>
</head>
<body>
    <button class="open-modal">Abrir modal</button>

    <p>Lorem ipsum dolor sit, amet consectetur adipisicing elit. Et, aut quaerat! Repellendus minima, animi dicta excepturi est repudiandae fuga quas deserunt aperiam possimus quae quod iusto, adipisci quaerat porro hic laborum ut nobis, id soluta saepe vero. Nostrum error quaerat, tempore illum quae eos doloremque assumenda cum commodi. Tempora earum optio illum velit ratione quos facere eveniet ipsa, animi aperiam soluta qui, odio omnis ex eligendi, harum minima repudiandae consectetur. Officiis vel nemo incidunt commodi veniam dicta harum autem iure dolore temporibus expedita hic fugiat numquam consequatur inventore sint reiciendis, aspernatur odio. Molestiae, quam aspernatur rem illum rerum atque totam veritatis maiores unde repellat sed ex similique. Quas odit at mollitia blanditiis ullam nesciunt, repellat enim soluta tenetur ad saepe ut tempora eos. Beatae aliquid maiores voluptates enim commodi alias ipsam, cumque iusto illum impedit repellendus laudantium officia modi nisi libero fugiat magni non in sint similique distinctio dolorum assumenda. Tenetur veritatis tempora at cum, inventore quae cumque veniam blanditiis et fugit. Rem quae blanditiis hic, necessitatibus, minus suscipit dolorum reprehenderit sunt voluptate dignissimos non nostrum aperiam, eaque cupiditate. Soluta magnam quaerat eos natus ducimus iusto ipsa esse exercitationem quidem illum, obcaecati perspiciatis ullam debitis sunt reprehenderit incidunt non possimus quos odio expedita quo. Eos voluptates ducimus nesciunt suscipit animi velit sint ad qui eligendi fugit. Dolorem explicabo laudantium aspernatur, tempore modi sequi possimus animi, reprehenderit ut quia dolor labore illum vitae rerum, tenetur tempora molestiae ratione. Expedita odio alias nesciunt, vero obcaecati, quo dolore aut optio numquam magnam consectetur earum quae molestias totam, ea ut dignissimos iure. Eaque laudantium voluptatibus autem? Officiis tempore explicabo error magnam odio! Laboriosam sed autem non ipsam debitis tempora harum voluptatibus et, amet cupiditate commodi cumque repudiandae! Sit architecto saepe nemo dolor hic expedita! Itaque ipsum dolorem et modi eos fugit animi, labore ducimus aperiam beatae. Quos, voluptates ipsa laboriosam mollitia quae cum alias nobis corporis voluptatem quibusdam corrupti esse consequuntur officiis blanditiis autem veritatis recusandae natus aut libero iure deserunt. Dolore amet ab ratione eos doloremque, commodi fugiat architecto explicabo vel quaerat necessitatibus sed cupiditate eum molestiae rem officia natus dicta id optio qui quod voluptate? Qui alias aperiam sint aspernatur non ipsa maiores, fugiat voluptates dignissimos in iste delectus fugit explicabo ab voluptatum impedit officia voluptatibus optio vitae veritatis? Voluptatem sed quos suscipit consequuntur distinctio odit sequi est. Consequuntur iusto nihil ratione sunt veritatis, magnam dolores vitae laborum iure iste, laboriosam, molestiae atque similique aliquam totam. Quibusdam animi ratione ea, nihil perspiciatis facilis maiores exercitationem ipsam, perferendis quia necessitatibus vel. Quae voluptates, laudantium asperiores unde qui excepturi rerum et repudiandae quod alias deleniti culpa quis earum saepe exercitationem atque impedit, laboriosam possimus, velit autem voluptate. Iste doloremque cupiditate, ducimus harum quisquam necessitatibus voluptatibus ullam quae numquam voluptatem, minima suscipit soluta? Illum fugiat laborum id iste! Aut quas cumque eius commodi, perferendis autem voluptatum nemo aliquid! Iste, voluptatem, amet nobis, maxime molestias laboriosam quibusdam pariatur sapiente dignissimos ea corrupti vero est veniam? Optio impedit pariatur veniam iusto in illo voluptatum maiores ut officia dignissimos ducimus voluptatibus velit rerum, error hic accusamus molestiae eaque aspernatur molestias deserunt asperiores. Eum mollitia explicabo perferendis molestias soluta atque ipsa, blanditiis aliquam eaque nam cum tempore. Eum ipsam, quae recusandae consectetur temporibus provident omnis blanditiis atque laudantium optio! Vitae nemo hic ullam ut amet. Reiciendis suscipit libero possimus assumenda voluptatibus nobis, soluta ipsa debitis doloremque explicabo earum labore autem animi et consequatur eius nihil sed porro ducimus qui? Aut quasi inventore maxime fugiat, mollitia animi numquam? Quibusdam, deleniti aut inventore quos debitis error quis harum ab modi illo explicabo. Ex, cumque! Magnam, nemo. Labore veritatis magnam voluptate accusantium repellat provident, unde deleniti eos harum molestias tenetur alias ipsum iure atque delectus? Veniam officiis in voluptate blanditiis aspernatur, dicta labore rem deserunt nemo cum eos ducimus laboriosam natus nam qui animi laudantium enim ut eum architecto ratione neque. Ipsum pariatur eius adipisci saepe? Id, dolor alias sed quis aspernatur excepturi assumenda, mollitia autem, quo suscipit possimus porro doloremque blanditiis dignissimos modi. Nihil hic cumque iure, esse omnis iusto! Voluptates corporis rem beatae fugiat eos cum ab, quam repellat delectus quia? Vero cum voluptatem dicta! Alias ab distinctio consequuntur. Illo minima sint asperiores delectus tenetur sit dolor molestias quasi porro. Est, a dolores. Eos consectetur cumque eveniet consequuntur recusandae exercitationem suscipit odit itaque, facere, veniam eligendi laboriosam minima doloribus dolore necessitatibus earum sit. Possimus sequi minus tempora laudantium, eos ea molestiae architecto quidem voluptatibus earum magnam atque labore nemo hic consequatur ipsam deleniti pariatur, neque vel perferendis ratione explicabo? Laborum facilis, corporis expedita dolorem eaque, ratione molestiae modi atque nulla blanditiis accusamus sit vitae culpa rem eos aut ducimus quod reiciendis ad tenetur eligendi, nisi consequatur. Quaerat, tempora quod! Nobis, minima in eos ea nostrum quibusdam reiciendis consequuntur saepe quos sint incidunt praesentium excepturi vero aspernatur libero est, velit hic, eius ipsam molestiae iure repudiandae ex. Aliquam sequi iste natus animi accusantium quod nesciunt quo? Necessitatibus error obcaecati cupiditate voluptates veritatis corrupti consequuntur id recusandae? Suscipit nobis nulla beatae eligendi quis voluptatem temporibus accusantium animi eveniet, reiciendis et incidunt possimus porro magni laudantium culpa quae dolor eum maxime. Veniam error mollitia reiciendis recusandae dolorem doloribus ipsa ratione, laboriosam voluptas accusamus hic maiores nesciunt provident repudiandae iure fuga alias repellat, dolores magni deserunt vitae consequatur! Blanditiis quo doloribus aut accusantium sunt qui expedita nam ex distinctio. Minima reiciendis placeat laudantium voluptas aut iusto reprehenderit dignissimos? Odio ut distinctio delectus, suscipit incidunt dolore exercitationem quo quisquam eaque voluptas similique ea ex explicabo optio vitae aspernatur atque dicta nisi? Nihil, recusandae minus. Fuga fugiat necessitatibus velit, consectetur distinctio itaque dolore facilis ea quod voluptate eligendi qui deserunt dolor iure eum voluptas, dignissimos, quia quo nemo. Mollitia nisi dolores, porro ratione aliquid vitae, eos recusandae, quasi modi omnis eveniet accusamus nostrum! Maiores esse consectetur, porro doloremque dicta magni commodi eaque illo vel nesciunt ipsam? Cupiditate sequi fugiat fugit! Rem placeat ducimus vel ipsa commodi iusto asperiores, ut quos id iure? Velit nulla fugit vel veritatis aperiam ea dignissimos ex! Alias odio commodi provident similique.</p>

    <div class="modal">
        <div class="modal-body">
            <div class="close">
                <img src="./close.svg" alt="Fechar Modal" class="close-modal">
            </div>

            <div class="iframe-res" data-url="https://www.youtube.com/embed/lJ8NY9_i45M">
                <!-- VIDEO CONTAINER -->
            </div>
        </div>
    </div>

    <!-- Amostrar de vídeo -->
    <!-- https://www.youtube.com/embed/lJ8NY9_i45M -->
    <!-- https://player.vimeo.com/video/238447560 -->

    <script>
        // Função para mostrar/esconder o modal
        function toggleModalVisibility() {
            // Serviços de vídeo suportados por este modal.
            const YOUTUBE = 'youtube'
            const VIMEO = 'vimeo'

            // Propriedades do modal.
            var modal = $('.modal')
            var modalBody = modal.find('.modal-body')
            var iframeContainer = modalBody.find('.iframe-res')

            // Vídeo a ser reproduzido
            var container = modal.find('.iframe-res')
            var videoUrl = container.data('url')
            var videoType = ''

            if (videoUrl.includes(YOUTUBE)) {
                videoType = YOUTUBE
            } else if (videoUrl.includes(VIMEO)) {
                videoType = VIMEO
            } else {
                throw new Error('Serviço não suportado')
            }

            // Construimos o iframe de acordo com o serviço de vídeo
            var iframe = buildIframeForVideo(videoType, videoUrl)

            // Este modal será aberto ou já está aberto?
            if (modal.hasClass('modal-opened')) {
                modalBody.removeClass('modal-body-opened')

                setTimeout(function() {
                    iframeContainer.find('iframe').remove()
                    modal.removeClass('modal-opened')
                }, 310)
            } else {
                modal.addClass('modal-opened')
                modalBody.addClass('modal-body-opened')
                $(iframe).appendTo(iframeContainer)
            }
        }

        function buildIframeForVideo(type, url) {
            const YOUTUBE = 'youtube'
            const VIMEO = 'vimeo'

            if (typeof(type) !== 'string') {
                throw new Error('Tipo de vídeo indefinido.')
            }

            if (type === YOUTUBE) {
                return '<iframe src="'+url+'?autoplay=true" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>'
            } else {
                return '<iframe src="'+url+'?autoplay=true" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe>'
            }
        }

        $('.open-modal, .modal, modal-body .close').on('click', toggleModalVisibility)
    </script>
</body>
</html>